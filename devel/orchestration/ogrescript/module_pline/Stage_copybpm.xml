   <target name="Stage_copybpm" description="transfer bpm image">
       <esequence>

        <edeclare name="content_begin"  string="test begin"/>
        <edeclare name="content_end"    string="test end"/>
        <econdblock type="else-if">
          <econdtask>
            <eeval>
             <statement>
                <ecompare string="${platform}">
                   <predicate string="TG" comparator="EQUALS"/>
                </ecompare>
             </statement>
            </eeval>
              <esequence>
                <eassign name="content_begin"  string="Begin Stage_copybpm for ccd ${ccd.num} data on $G{host} for nite ${nite}"/>
                <eassign name="content_end"    string="End Stage_copybpm for ccd ${ccd.num} data on $G{host} for nite ${nite}"/>
              </esequence>
          </econdtask>
              <esequence>
                <eassign name="content_begin"  string="Begin Stage_copybpm for ccd ${ccd.num} for nite ${nite}"/>
                <eassign name="content_end"    string="End Stage_copybpm for ccd ${ccd.num} for nite ${nite}"/>
              </esequence>
        </econdblock>

            <publish>
              <event ensembleid="${ensemble.id}" workflowid="${jid}"
                   nodeid="$R{content_begin}" currentState="1">
                   <property name="message" value="$R{content_begin}"/>
              </event>
            </publish>

            <edeclare name="target" string="${bpm.dir}/${bpm.name}"/>
            <edeclare name="destination" string="${data.protocol}://${bpm.fits.name}"/>

            <uricopy from="$R{target}" to="$R{destination}"/>

            <write path="${local.out}/${log.name}" text="true"
                    errorProperty="failed" rethrow="false" append="true">
              <segment string=" -- Stage_copybpm success" lineBreaks="1"/>
            </write>
            <print line=" - Stage_copybpm done"/>

            <publish>
              <event ensembleid="${ensemble.id}" workflowid="${jid}"
                   nodeid="$R{content_end}" currentState="1">
                   <property name="message" value="$R{content_end}"/>
              </event>
            </publish>
        </esequence>
   </target>
