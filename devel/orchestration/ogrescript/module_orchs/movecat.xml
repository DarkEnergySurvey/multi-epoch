<define procedure="Stage_movecat" ARG_0="int">
    <properties file="${mypath}/module_orchs/movecat.properties"/>
    <env/>
    <properties sysprops="true"/>
    <send>
        <progress-event message="Begin Stage_movecat">
            <header-property name="some-special-id" value="${ensemble.id}-Main-Begin-Stage_movecat"/>
        </progress-event>
    </send>
    <echo stdout="true" message=" - Begin Stage_movecat"/>
    <declare name="end" long="$E{ ${ccd.stop} + 1 }"/>
    <declare name="i" int="0"/>
    <for var="i" from="${ccd.start}" condition="$E{${i} &lt; ${end}}">
        <declare name="in" long="0"/>
        <add-leading-zeros number="${i}" places="2">
            <return-value defaultName="zerosAdded" assignedName="in"/>
        </add-leading-zeros>
        <echo stdout="true" message=" -- Running Stage_movecat - GridFTP usnob-catalog for CCD${in} ... "/>
        <declare name="srcdir" string="${job.id}/${local_catpath}/${in}/USNOB_${in}.fits"/>
        <declare name="targetdir" string="${targetprot}://${tgrid_server}${tgrid_homepath}/${in}_${uid}/data/${nite}/log/"/>
<!--
               <copy sourceDir="${srcdir}" target="${targetdir}" />
-->
        <copy>
            <source base="file:${srcdir}/">
                <include>*</include>
            </source>
            <target>file:${targetdir}</target>
        </copy>
<!--
   <copy taskName="test_copy" verbose="true">
        <targetGroup targetURI="${targetdir}">
               <pattern base="${srcdir}">
               </pattern>
        </targetGroup>
   </copy>
-->
        <delete dir="file:${job.id}/${local_catpath}/${in}">
            <configuration>
                <property name="delete-fail-on-error" value="false" type="boolean"/>
            </configuration>
        </delete>
    </for>
    <echo stdout="true" message=" - Stage_movecat done"/>
    <echo stdout="true" message="  "/>
    <send>
        <progress-event message="End Stage_movecat">
            <header-property name="some-special-id" value="${ensemble.id}-Main-End-Stage_movecat"/>
        </progress-event>
    </send>
</define>

