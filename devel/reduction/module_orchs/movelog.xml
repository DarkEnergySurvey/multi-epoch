   <target name="Stage_movelog" description="Move image lists to teragrid">
    <property file="${mypath}/module_orchs/movelog.properties"/>

    <esequence>

        <publish>
           <event ensembleid="${ensemble.id}"
                 workflowid="Main"
                 nodeid="Begin Stage_movelog"
                 currentState="0">
                  <property name="message" value="Begin Stage_movelog"/>
           </event>
        </publish>

     <print line=" - Begin Stage_movelog"/>

     <edeclare name="end" long="$E{ ${ccd.stop} + 1 }"/> 
     <eloop counterName="i" initialValue="${ccd.start}">
          <ecounter>
               <expression infix="$R{i} &lt; $R{end}"/>
          </ecounter>           

          <!-- convert 1,...,9 to 01,...,09 -->

          <econdblock type="else-if">
            <econdtask>
              <eeval>
                <statement> 
                  <ecompare long="$R{i}">
                    <predicate long="10" comparator="LT"/>
                  </ecompare> 
                 </statement>
              </eeval>
                <edeclare globalName="in" string="0$R{i}"/>
            </econdtask>
                <edeclare globalName="in" long="$R{i}"/>
          </econdblock>
 
              <print line=" -- Running Stage_movelog - GridFTP /log dir for CCD$R{in} ... "/>

              <edeclare name="srcdir"  string="${local_listpath}/log"/>
              <edeclare name="targetdir" string="${targetprot}://${tgrid_server_${site}}${tgrid_homepath_${site}}/${uid}_$R{in}/data/${nite}"/>
              
              <uricopy from="$R{srcdir}" to="$R{targetdir}">
              </uricopy>    

     </eloop>

     <print line=" - Stage_movelog done"/>
     <print line="  "/>

        <publish>
           <event ensembleid="${ensemble.id}"
                 workflowid="Main"
                 nodeid="End Stage_movelog"
                 currentState="0">
                  <property name="message" value="End Stage_movelog"/>
           </event>
        </publish>

    </esequence>
   </target>
